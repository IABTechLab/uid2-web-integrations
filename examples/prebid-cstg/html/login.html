<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>UID2 Prebid.js CSTG Integration Example</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/app.css" />
    <link rel="shortcut icon" href="/images/favicon.png" />
    <script defer src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script defer src="/scripts/prebid.js"></script>
    <script>
      var pbjs = pbjs || {};
      pbjs.que = pbjs.que || [];
      pbjs.que.push(function () {
        pbjs.setConfig({
          debug: true,
        });
        $(document).ready(onDocumentReady);
      });
    </script>
    <script>
      function onDocumentReady() {
        $('#login').click(async () => {
          const email = $('#email').val();
          pbjs.mergeConfig({
            userSync: {
              userIds: [
                {
                  name: 'uid2',
                  params: {
                    uid2ApiBase: '{{ UID2_BASE_URL }}',
                    subscriptionId: '{{ SUBSCRIPTION_ID }}',
                    serverPublicKey: '{{ SERVER_PUBLIC_KEY }}',
                    email,
                  },
                },
              ],
            },
          });
          window.location.replace('/');
        });
      }
    </script>
  </head>
  <body>
    <h1>UID2 Prebid.js CSTG Integration Example</h1>
    <div id="login_form" class="form">
      <div class="email_prompt">
        <input
          type="text"
          id="email"
          name="email"
          placeholder="Enter an email address"
          style="border-style: none"
          value="test@example.com"
        />
      </div>
      <div><button type="button" class="button" id="login">Log In</button>></div>
    </div>
  </body>
</html>
